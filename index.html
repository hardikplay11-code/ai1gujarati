<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Reviews</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{font-family:Arial,Helvetica,sans-serif;background:#fafafa;margin:0;padding:20px}
h2{text-align:center}
.review-form, .reviews{max-width:600px;margin:20px auto;background:#fff;padding:16px;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.08)}
input,textarea,button{width:100%;padding:10px;margin:8px 0;border-radius:8px;border:1px solid #ccc}
button{background:#ff9933;color:#fff;font-weight:bold;border:none;cursor:pointer}
.review{border-bottom:1px solid #eee;padding:10px 0}
.review:last-child{border:none}
.stars{color:#ff9933}
img{max-width:100%;border-radius:8px;margin-top:8px}
</style>
</head>
<body>

<h2>Customer Reviews</h2>

<div class="review-form">
  <input id="name" placeholder="Your name">
  <input id="rating" type="number" min="1" max="5" placeholder="Rating (1–5)">
  <textarea id="text" placeholder="Write your review"></textarea>
  <input id="image" type="file" accept="image/*">
  <button onclick="submitReview()">Submit Review</button>
</div>

<div class="reviews" id="reviews"></div>

<script>
const REVIEW_API = "https://script.google.com/macros/s/AKfycby8xjafTe0f34HafnoeAT3z7ArNSD8gw6D-ymkeFGtqVFlYZv7eFelBL4SmcOTeZiUQ/exec";

function submitReview(){
  const name = document.getElementById("name").value.trim();
  const rating = document.getElementById("rating").value;
  const text = document.getElementById("text").value.trim();
  const file = document.getElementById("image").files[0];

  if(!name || !rating || !text){ alert("Fill all fields"); return; }

  if(file){
    const reader = new FileReader();
    reader.onload = () => send(reader.result);
    reader.readAsDataURL(file);
  } else {
    send("");
  }

  function send(img){
    fetch(REVIEW_API,{
      method:"POST",
      body:JSON.stringify({name,rating,text,img})
    }).then(()=>{
      alert("Review submitted for approval");
      document.querySelector(".review-form").reset?.();
    });
  }
}

function loadReviews(){
  fetch(REVIEW_API + "?action=list")
    .then(r=>r.json())
    .then(data=>{
      reviews.innerHTML="";
      data.forEach(r=>{
        reviews.innerHTML += `
          <div class="review">
            <strong>${r.name}</strong><br>
            <span class="stars">${"★".repeat(r.rating)}</span>
            <p>${r.text}</p>
            ${r.img ? `<img src="${r.img}">` : ""}
          </div>
        `;
      });
    });
}

loadReviews();
</script>

</body>
</html>
