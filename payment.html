<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Payment | Ai1 Gujarati Snacks</title>

<style>
body {
  font-family: 'Segoe UI', Arial;
  background:#fff4e0;
  margin:0;
  padding:20px;
  color:#3a2e25;
}

.box {
  background:#fff;
  padding:20px;
  border-radius:16px;
  box-shadow:0 4px 14px rgba(0,0,0,0.1);
  margin-bottom:25px;
}

h2 {
  text-align:center;
  font-size:26px;
  font-weight:800;
  margin-bottom:10px;
}

.amount-box {
  font-size:22px;
  text-align:center;
  background:#ffedd5;
  padding:12px;
  border-radius:12px;
  font-weight:700;
  margin-bottom:25px;
}

.btn {
  width:100%;
  padding:16px;
  border:none;
  border-radius:12px;
  font-size:18px;
  font-weight:700;
  cursor:pointer;
  margin-top:12px;
}

.cod-btn { background:#ff9933; color:white; }
.upi-btn { background:#25d366; color:white; }
.confirm-btn { background:#25d366; color:white; }

.qr {
  display:block;
  width:260px;
  height:260px;
  margin:0 auto;
  border-radius:12px;
  object-fit:cover;
  box-shadow:0 4px 14px rgba(0,0,0,0.15);
}

#successBox {
  display:none;
  padding:20px;
  background:#d1fae5;
  color:#065f46;
  border-radius:12px;
  text-align:center;
  font-size:19px;
  font-weight:600;
  margin-top:20px;
}
</style>
</head>

<body>

<h2>Complete Your Payment</h2>

<div id="amountBox" class="amount-box">Amount: â‚¹0</div>

<div class="box">
  <h3 style="text-align:center; font-size:20px;">Pay Using UPI</h3>

  <img src="upi-qr.jpg" class="qr" alt="UPI QR">

  <button class="btn confirm-btn" onclick="confirmPayment()">âœ… I Have Paid</button>
</div>

<div class="box">
  <h3 style="text-align:center; font-size:20px;">Or Choose COD</h3>
  <button class="btn cod-btn" onclick="submitCOD()">ðŸšš Cash on Delivery</button>
</div>

<div id="successBox"></div>

<script>
const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxXGK5MY1jk4M8yBhQKEQjWu3SXoPfQK4rsgGgi-ibKl00eF60OdhaADE1fBZOZrU-0lA/exec";

let amount = new URLSearchParams(window.location.search).get("amount") || 0;
document.getElementById("amountBox").innerText = "Amount: â‚¹" + amount;

// ----------------------------
// SHOW SUCCESS MESSAGE
// ----------------------------
function showSuccess(msg) {
  const box = document.getElementById("successBox");
  box.innerHTML = msg;
  box.style.display = "block";
  window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
}

// ----------------------------
// UPI CONFIRMATION
// ----------------------------
function confirmPayment() {
  let orderId = "OD" + Date.now();

  fetch(APPS_SCRIPT_URL, {
    method: "POST",
    mode: "no-cors",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({
      paymentConfirmed: true,
      method: "UPI",
      amount: amount,
      orderId: orderId,
      timestamp: new Date().toISOString()
    })
  });

  showSuccess(`
    âœ… Payment Confirmed!<br><br>
    ðŸ§¾ Order ID: <b>${orderId}</b><br>
    ðŸ’° Paid: <b>â‚¹${amount}</b><br><br>
    Thank you! Your order has been placed successfully.
  `);
}

// ----------------------------
// COD CONFIRMATION
// ----------------------------
function submitCOD() {
  let orderId = "OD" + Date.now();

  fetch(APPS_SCRIPT_URL, {
    method: "POST",
    mode: "no-cors",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({
      paymentConfirmed: false,
      method: "COD",
      amount: amount,
      orderId: orderId,
      timestamp: new Date().toISOString()
    })
  });

  showSuccess(`
    ðŸšš COD Order Placed<br><br>
    ðŸ§¾ Order ID: <b>${orderId}</b><br>
    ðŸ’° Amount: <b>â‚¹${amount}</b><br><br>
    Thank you! We will call you to confirm your address.
  `);
}
</script>

</body>
</html>
